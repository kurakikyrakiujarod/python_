 # Selenium 处理滚动条

selenium提供了一个操作js的方法:execute_script()，可以直接执行js的脚本。

## 一. 控制滚动条高度

滚动条回到顶部：

```python
js="var q=document.getElementById('id').scrollTop=0"
driver.execute_script(js)
```

滚动条拉到底部

```python
js="var q=document.documentElement.scrollTop=10000"
driver.execute_script(js)
```

可以修改scrollTop 的值，来定位右侧滚动条的位置，0是最上面，10000是最底部。


以上方法适用Firefox和IE浏览器。Chrome浏览器兼容办法：

```python
js = "var q=document.body.scrollTop=0"
driver.execute_script(js)
```

## 二.横向滚动条
通过左边控制横向和纵向滚动条scrollTo(x, y)

```python
js = "window.scrollTo(100,400)"
driver.execute_script(js)
```

## 三.元素聚焦

```python
target = driver.find_element_by_xxxx()
driver.execute_script("arguments[0].scrollIntoView();", target)
```

## 四. 参考代码

```python
from selenium import webdriver
from lxml import etree
import time

url = "https://search.jd.com/Search?keyword=%E7%AC%94%E8%AE%B0%E6%9C%AC&enc=utf-8&wq=%E7%AC%94%E8%AE%B0%E6%9C%AC&pvid=845d019c94f6476ca5c4ffc24df6865a"
# 加载浏览器
wd = webdriver.Firefox()
# 发送请求
wd.get(url)
# 要执行的js
js = "var q = document.documentElement.scrollTop=10000"
# 执行js
wd.execute_script(js)

time.sleep(3)
# 解析数据
e = etree.HTML(wd.page_source)
# 提取数据的xpath
price_xpath = '//ul[@class="gl-warp clearfix"]//div[@class="p-price"]/strong/i/text()'
# 提取数据
infos = e.xpath(price_xpath)

print(len(infos))
# 关闭浏览器
wd.quit()
```

