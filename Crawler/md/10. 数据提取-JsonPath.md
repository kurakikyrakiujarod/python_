

### 4. JsonPath
安装方法：`pip install jsonpath`

官方文档：http://goessner.net/articles/JsonPath

### 5. JsonPath与XPath语法对比
Json结构清晰，可读性高，复杂度低，非常容易匹配，下表中对应了XPath的用法
XPath | JSONPath | 描述
--|--|--
/ |	$ | 根节点
. |	@ | 现行节点
/ |	.or[] |	取子节点
..| n/a| 	取父节点，Jsonpath未支持
//| .. | recursive descent. JSONPath borrows this syntax from E4X. 
* |	* |匹配所有元素节点
@ |	n/a| 	根据属性访问，Json不支持，因为Json是个Key-value递归结构，不需要。
[]| [] |	迭代器标示（可以在里边做简单的迭代操作，如数组下标，根据内容选值等）
\|| [,] | Union operator in XPath results in a combination of node sets. JSONPath allows alternate names or array indices as a set. 
[]| ?()| 	支持过滤操作.
n/a| ()| 	支持表达式计算
() |n/a| 	分组，JsonPath不支持

### 6. 示例
拉勾网城市JSON文件 http://www.lagou.com/lbs/getAllCitySearchLabels.json 
```python
from urllib.request import urlopen
from urllib.request import Request
from fake_useragent import UserAgent
import jsonpath
import json

url = 'http://www.lagou.com/lbs/getAllCitySearchLabels.json'
headers = {
    "User-Agent": UserAgent().random
}
request = Request(url,headers=headers)
response = urlopen(request)
html = response.read()
# 把json格式字符串转换成python对象
jsonobj = json.loads(html.decode())
# 从根节点开始，匹配name节点
citylist = jsonpath.jsonpath(jsonobj,'$..name')
print(citylist)
print(type(citylist))
fp = open('city.json','w')
# 序列化
content = json.dumps(citylist, ensure_ascii=False)
print(content)
fp.write(content)
fp.close()
```

### 7. 注意事项

- json.loads() 是把 Json格式字符串解码转换成Python对象，如果在json.loads的时候出错，要注意被解码的Json字符的编码。如果传入的字符串的编码不是UTF-8的话，需要指定字符编码的参数 encoding。
   ```python
   dataDict = json.loads(jsonStrGBK)
   ```
- dataJsonStr是JSON字符串，假设其编码本身是非UTF-8的话而是GBK 的，那么上述代码会导致出错，改为对应的：

     ```python
     dataDict = json.loads(jsonStrGBK, encoding="GBK")
     ```

- 如果 dataJsonStr通过encoding指定了合适的编码，但是其中又包含了其他编码的字符，则需要先去将dataJsonStr转换为Unicode，然后再指定编码格式调用json.loads()。
    ```python
    dataJsonStrUni = dataJsonStr.decode("GB2312")
    dataDict = json.loads(dataJsonStrUni, encoding="GB2312")
    ```

