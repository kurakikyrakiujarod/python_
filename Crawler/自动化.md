```
adb shell dumpsys window | findstr windows
adb shell dumpsys activity
adb shell dumpsys window | findstr mCurrentFocus
python -m weditor
pip install -U weditor
python -m uiautomator2 init
python3 -m uiautomator2 init --serial 127.0.0.1:62001
pip install -U --pre uiautomator2
adb kill-server
adb start-server
adb devices
adb version
```

```
变量名：Path
变量值：C:\ProgramData\Oracle\Java\javapath;%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin
新建
变量名：JAVA_HOME
变量值：D:\Program files\Java\jdk
新建
变量名：CLASSPATH
变量值：.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;
```

SDK环境设置

```
ANDROID_HOME	C:\SDK
PATH	;%ANDROID_HOME%\platform-tools;%ANDROID_HOME%\tools;
```

```python
import uiautomator2 as u2
# d = u2.connect('127.0.0.1:62001')

d = u2.connect()

# 启动App
d.app_start("com.android.settings")

print(d.info)
d.press("home")
d.screen_off()

d(text='微信', className='android.widget.TextView').click()

# stop all
d.app_stop_all()
# stop all app except for com.examples.demo
# d.app_stop_all(excludes=['com.examples.demo'])

d.app_info("com.tencent.mm")

img = d.app_icon("com.tencent.mm")
img.save("icon.png")

d.push("foo.txt", "/sdcard/")

pull a file from the device
d.pull("/sdcard/tmp.txt", "tmp.txt")

# 检查并维持设备端守护进程处于运行状
d.healthcheck()

sess = d.session("com.google.android.calculator") 
sess.close()

with d.session("com.google.android.calculator") as sess:
    sess(text="7").click()
    
sess = d.session("com.google.android.calculator")
sess(text="9").click()
sess(text="删除").click()

print(d.window_size())

print(d.current_app())

print(d.serial)

print(d.wlan_ip)

print(d.device_info)

d.screen_on() # turn on the screen
d.screen_off() # turn off the screen

d.info.get('screenOn') # require Android >= 4.4

d.press("home") # press the home key, with key name
d.press("back") # press the back key, with key name

d.click(x, y)
d.double_click(x, y)
d.long_click(x, y, 0.5) # long click 0.5s (default)

d.swipe(sx, sy, ex, ey)
d.swipe(sx, sy, ex, ey, 0.5) # swipe for 0.5s(default)

d.drag(sx, sy, ex, ey)
d.drag(sx, sy, ex, ey, 0.5) # swipe for 0.5s(default)

d.swipe_points([(x0, y0), (x1, y1), (x2, y2)], 0.2))

d.touch.down(10, 10) # 模拟按下
d.touch.move(15, 15) # 模拟移动
d.touch.up() # 模拟抬起

# retrieve orientation. the output could be "natural" or "left" or "right" or "upsidedown"
orientation = d.orientation
d.set_orientation('l') # or "left"
d.set_orientation("l") # or "left"
d.set_orientation("r") # or "right"
d.set_orientation("n") # or "natural"

# take screenshot and save to a file on the computer, require Android>=4.2.
d.screenshot("home.jpg")

# get opencv formatted images. Naturally, you need numpy and cv2 installed first
import cv2
image = d.screenshot(format='opencv')
cv2.imwrite('home.jpg', image)

# get raw jpeg data
imagebin = d.screenshot(format='raw')
open("some.jpg", "wb").write(imagebin)

# get the UI hierarchy dump content (unicoded).
xml = d.dump_hierarchy()

d.open_notification()
d.open_quick_settings()
d(text='浏览器', className='android.widget.TextView').click()

d(className="android.view.View").child(text="微信").click()
```

```python
answers_elems = d.xpath('//*[@resource-id="cn.com.askparents.parentchart:id/anslist"]/android.widget.LinearLayout')
nums = len(answers_elems.all())
```

```python
# coding:utf-8
import os

# popen返回文件对象，跟open操作一样
f = os.popen(r"adb devices", "r")
shuchu = f.read()
f.close()

print(shuchu)  # cmd输出结果

# 输出结果字符串处理
s = shuchu.split("\n")   # 切割换行
new = [x for x in s if x != '']  # 去掉空''
print(new)


# 可能有多个手机设备
devices = []  # 获取设备名称
for i in new:
    dev = i.split('\tdevice')
    if len(dev)>=2:
        devices.append(dev[0])

if not devices:
    print("手机没连上")
else:
    print("当前手机设备:%s"%str(devices))
```

```python
os.system('python -m uiautomator2 init')
```

nox_adb.exe